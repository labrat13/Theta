++ Сборка Транзакции БД

++++Транзакции
* Если откатывать ТранзакцияБД, она откатывается до самого первого вызова транзакции. Вложенные транзакции не получаются. 
* todo.концепция.бд: Надо изучить работу [Движок]а, чтобы решить, где транзакция должна начинаться, где заканчиваться, и как обрабатывать откат транзакции. Для этого надо строить диаграммы УМЛ для операций [Движок].
++++Транзакции
См. wiki:///V:/МоиПроекты/myWiki/MyWiki/MyWiki.wiki?page=SQLite.
В механизмах транзакций всех БД вложенные транзакции не поддерживаются. 
Это значит, что нельзя полностью откатить сложную операцию, использующую отдельные методы, которые тоже используют транзакции.
Например, пользователь вызывает метод А, который начинает транзакцию а, затем вызывает метод Б, который начинает транзакцию б.
Если метод Б неудачен, он откатывает транзакцию б, и возвращает ошибку. 
Метод А затем или вызывает другой метод С, который выполняет алгоритм другим путем, или откатывает транзакцию а и возвращает ошибку.
Тут надо, чтобы внутри транзакции а можно было открыть и откатить транзакцию б. Коммит транзакции б должен приводить к завершению транзакции б и выход в транзакцию а.
Хотя вроде бы в Microsoft sql server 2005 такое есть, но это надо проверять экспериментально.
А остальные БД это наверно не поддерживают.
Еще в движке есть вариант СолюшенБезБД, где транзакций вообще не предусмотрено.

Предлагается сделать собственный модуль транзакций на базе [Лог]а.
В [Лог] выводить дамп объекта до и после операции и код операции. 
Это одновременно [Лог] движка и [Лог] транзакций.
Объекты должны сериализовываться в компактный дамп для выведения в [Лог] и передачи по сети.
Этот [Лог] будет очень большим. Удалять из него старые записи нежелательно - это не позволит откатывать базу обратно, если потребуется откатить БД на несколько сеансов назад.
Но [Лог] будет огромным. Тут можно попробовать оптимизацию, но лучше просто писать все в [Лог].
 [Лог]должен содержать еще и комментарии пользователя и комментарии, вставляемые в методах в целях отладки.
Тогда можно использовать все движки БД, используя ТранзакцияСолюшена через [Лог].
Эту подсистему [Лог]а надо сделать слоем между [Контейнер]ом и АдаптерБД. Она независима от БД, поскольку операции [Движок]а одни и те же.
Ей отправляются команды по получению-отправке данных, и она же будет производить [Лог] и откатывать ТранзакцияСолюшена.
Надо это продумать.