++ Солюшен Без БД
[template: ШаблонКарточкиГлоссария]
Состояние: [//ДОПОЛНИТЬ]

Вид конфигурации Солюшена, при котором не используется постоянное хранилище данных (СУБД).


+++Версии
* todo.глоссарий.форма: Создайте новую страницу для версии описания сущности, добавив к имени "Версия0". Так осуществляется поддержка версий страниц глоссария. 

+++Обязанности
* todo.глоссарий.форма: Перечислите обязанности сущности здесь.
* 

+++Сущности предметной области
* todo.глоссарий.форма: Перечислите выявленные сущности предметной области здесь.
* 

+++Соответствующий класс кода
Не представлена в коде.
++++Свойства - данные
++++Методы

+++Дополнительная информация 
* См. СписокРежимовЭксплуатацииСолюшена.
[Солюшен] может не иметь БД, в этом случае он хранит все состояние СтруктураСущностей в памяти или на диске в ПолныйСнимокСтруктуры. 
[Контейнер] загружается из ФайлПолногоСнимка, после работы результирующее состояние выгружается в ФайлПолногоСнимка. Как в Tapp2.
В таком солюшене невозможно сохранить ячейки, связи и контейнер в БД.
Только ВременнаяЯчейка MCellBt ячейки и только ВременнаяСвязь связи могут использоваться в таком проекте.
Так как некуда сохранять изменения - нет БД.
 
Поддержка солюшенов без БД была введена в прошлый КодДвижка без полного проектирования, поэтому нельзя считать прошлый КодДвижка образцом, его надо переделывать.

++++Загрузка ячейки в память
[Контейнер] имеет поле РежимСозданияЯчейки или DefaultCellMode. Оно определяет тип ячейки для автоматических операций, если он не задан явно пользователем. 
Поле РежимСозданияЯчейки используется в функции MEngine.S1_intGetCell(), где определяет тип загружаемой из БД ячейки, если ячейки еще нет в памяти. Когда СолюшенБезБД, поле  РежимСозданияЯчейки игнорируется, или должно быть всегда в состоянии ВременнаяЯчейка.

++++Специальный Адаптер БД для СолюшенБезБд
Класс адаптера АдаптерБД имеет один и тот же ИнтерфейсАдаптераБД для всех типов БД. 
Можно реализовать версию АдаптерБД для СолюшенБезБД, она будет игнорировать операции сохранения ЭлементСтруктурыСущностей.
АдаптерБД мог бы управлять значением РежимСозданияЯчейки, чтобы не допускать неправильных типов ячеек и связей. 
todo.концепция.солюшен.обсудить: Надо решить - АдаптерБД мог бы предлагать список допустимых значений для РежимСозданияЯчейки, или предлагать значение по умолчанию. Или перенести в его объект это свойство солюшена? Или при создании солюшена определять? 

++++Как определить состояние Солюшен без БД
Нужно убедиться, что КодДвижка, оперирующий в этом варианте, не использует БД.

Для серверного типа БД:
Солюшен считается не использующим БД, если ФайлСолюшена не содержит ПутьКСерверуСУБД. В этом случае значения полей имени БД, пользователя, пароля и таймаута в файле солюшена, игнорируются.
Для файлового типа БД: 
Солюшен считается не использующим БД, если ФайлСолюшена не содержит ПутьКФайлуБД. В этом случае значения полей имени БД, пользователя, пароля и таймаута в файле солюшена, игнорируются.

Лучшим решением тут будет хранить тип БД как свойство Солюшена, в файле ФайлСолюшена, указав его при создании [Солюшен]а. См. ПереченьТиповБд. Так как при открытии солюшена надо выбрать и загрузить АдаптерБД, соответствующий виду БазаДанныхСолюшена. Поскольку в концепции предполагаются разные виды СУБД.


++++Работа с солюшеном без БД
Ход работы:
1. Создание [Контейнер]а, открытие СеансПользователя.
2. Загрузка выбранной версии СтруктураСущностей в память из ФайлПолногоСнимка.
3. Работа: операции ячеек и связей - только с временными ячейками и связями.
4. Сохранение новой версии СтруктураСущностей в новый ФайлПолногоСнимка.
5. Закрытие СеансПользователя, уничтожение [Контейнер]а.
Соответственно, файл ПолныйСнимокСтруктуры должен содержать все необходимые для такой работы данные.

++++Транзакции БД
Если в операциях с ячейками ВременнаяЯчейка используются ТранзакцияБД, (этого не должно быть вообще-то, но может оказаться из-за совмещенного с остальными ячейками кода), надо от них избавляться, переделать КодДвижка. При необходимости отката операций придется использовать предыдущие снимки ПолныйСнимокСтруктуры или [Лог] и ТранзакцияСолюшена(см. [МенеджерЛога]).

++++Операции без БД
* Операции АдаптерБД, которые должны возвращать значение, возвращают то же, что и при пустой БД.
    * Open
    * Close
    * CreateConnectionString
    * getMaxCellId, getMaxLinkId
    * getMinCellId, getMinLinkId
    * операции поиска
    * ...
* операции сохранение проекта ProjectSave, сохранение ячейки MCell.Save должны выдавать исключение НеправильнаяОперацияСолюшенаБезБд. Так как некуда сохранять ячейки и незачем. Операция закрытие проекта с сохранением ProjectClose(True) должна выдавать исключение НеправильнаяОперацияСолюшенаБезБд вместо сохранения ячеек и связей.
    * todo.концепция.солюшен.обсудить: Хотя, может быть, не выдавать исключение, а просто молча не сохранять данные? Так вроде бы универсальнее? Можно сделать  специальную версию АдаптерБД, которая не будет ничего делать? И загружать ее согласно типу БД. 
* создание ячейки, иной, чем MCellBt, установка РежимСозданияЯчейки [MEngine_DefaultCellMode] в любое иное чем Temporary значение, должны выдавать исключение НеправильнаяОперацияСолюшенаБезБд.
* контейнер инициализирует РежимСозданияЯчейки [MEngine_DefaultCellMode] как Temporary.    
* операции, которые читают и пишут параметры ячеек и связей, должны выбрасывать исключение типа НеправильнаяОперацияСолюшенаБезБд. Это позволит отслеживать ошибки в реализации движка для режима СолюшенБезБД.
* некоторые операции могут оказаться исключением из этого правила.
* в солюшене не должно быть ЛокальнаяЯчейка ячеек иного типа, чем MCellBt или ВнешняяЯчейка ячейки любого типа - так как внешние ячейки не используют БазаДанныхСолюшена.
    * todo.концепция.солюшен.обсудить: Если ВнешняяЯчейка ячейки любого типа не используют локальную БД, наверно их можно использовать в СолюшенБезБД?  
* в проекте не должно быть связей, кроме временных. Связь, имеющая хотя бы одну временную ячейку - временная.
    * Логично, что раз нет ячеек, кроме временных, то и связи все временные будут. 
* Солюшен открывается без БД, это пустой солюшен, без НачальноеСостояниеСтруктурыСущностей, затем в него загружается ПолныйСнимокСтруктуры, и затем солюшен используется.
    * todo.концепция.солюшен.обсудить: Как можно открыть СолюшенБезБД пустым? Как он создается, как выглядит его структура файлов и вся инфраструктура? Как быть с файлами ФайлРесурса, которые описаны в загружаемом в контейнер ФайлПолногоСнимка? Откуда их брать? Сохранять файлы ФайлРесурса и иконки и прочее вместе со СнимокСтруктуры?
* ФайлПолногоСнимка может содержать постоянные ячейки и связи. Все ячейки и связи из СнимокСтруктуры загружаются как временные с другими идентификаторами. Или выбрасывается исключение - это надо обдумать, можно внести в настройки варианты способов загрузки.
* перед закрытием Солюшена пользователю придется вывести его в ПолныйСнимокСтруктуры. Хотя можно не сохранять, изменения пропадут.
* добавить пункты здесь...

+++Замечания
* а если у меня есть комплект солюшена с БД, и мне не хочется разворачивать БД, я мог бы загрузить весь контент в такой СолюшенБезБД, просмотреть, получить результат и закончить работу.
    * Так а откуда брать данные солюшена, если БД не открывать? СерверSQLБД все равно надо подключать. Так что вопрос не имеет смысла.
* А если у меня есть комплект солюшена с БД, но я хочу быстро провести интенсивную работу с этими данными солюшена, и мне не нужно сохранять изменения в БД солюшена?
    * Тогда я должен загрузить данные из БД солюшена в СолюшенБезБД, провести работу и закрыть солюшен.
    * Если в солюшене есть ПолныйСнимокСтруктуры, то можно загрузить солюшен из него, но он должен быть сделан перед самым закрытием солюшена. Это не гарантируется, поэтому либо надо делать такой снимок, и из него загружать СолюшенБезБД, что избыточно и долго, либо загружать СолюшенБезБД непосредственно из БазаДанныхСолюшена, что требует отдельного кода для решения этой редкой задачи. 
* А если у меня есть комплект солюшена с БД, и в нем есть ПолныйСнимокСтруктуры, и я из ПолныйСнимокСтруктуры снимка хочу взять данные солюшена?
    * Тогда я должен иметь возможность загрузить любой ПолныйСнимокСтруктуры в СолюшенБезБД. Не имеет значения, был ли солюшен с БД или без БД. Теоретически это вроде бы возможно. Надо это учесть в концепции и требованиях к ПолныйСнимокСтруктуры
    * Если ПолныйСнимокСтруктуры не был создан в конце работы, то более поздние изменения, хранящиеся в БазаДанныхСолюшена, будут недоступны. Это надо помнить.
    * Для ПолныйСнимокСтруктуры потребуются: некоторая ВерсияСолюшена и Дата Создания снимка.  
