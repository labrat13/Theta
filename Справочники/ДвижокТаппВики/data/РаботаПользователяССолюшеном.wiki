++ Работа Пользователя С Солюшеном

Из wiki:///V:/МоиПроекты/SIM/Работать%20здесь/NewConcept/NewConcept.wiki?page=РаботаПользователяССолюшеном

Это обобщенное описание базового набора операций пользователя с солюшеном.
Его необходимо уточнить, исходя из деталей устройства сущностей солюшена.

+++Получение состояния Движка
Из РаботаПользователяССолюшеном
* для проверки, что солюшен закрыт, надо организовать флаг. А то после закрытия приложение может попытаться выполнить еще операции с солюшеном. Хотя этот флаг нельзя в каждом шагу проверять, так что это ответственность приложения. Но можно ввести статическое поле в солюшен, что солюшен открыт/закрыт, чтобы сторонний код его опрашивал. Введено поле [MProject_m_isProjectActive]. Функции солюшена его используют.
* Можно предложить внедрить апи, подобный OleDbConnection, чтобы соединяться с контейнером солюшена, подобно БД SqliteСУБД.
Там и флаг этот - состояние подключения - есть и вполне органичен.
Только надо продумать как будут выглядеть функции такого объекта-контейнера, и как они должны будут использоваться и кем. 

+++Пользователь создает солюшен
Из РаботаПользователяССолюшеном
Пользователь открывает [Навигатор], выбирает команду создать новый [Солюшен].
Приложение с помощью диалога или мастера создания солюшена запрашивает свойства солюшена, затем проверяет их правильность (См ФайлСолюшена). 
Приложение вызывает статическую функцию [MProject_ProjectCreate]. Эта операция создает инфраструктуру нового солюшена - КаталогСолюшена, структуру каталогов и файлов, БД и таблицы в ней.
Если возникают ошибки, операция выкидывает исключения. Исключения обрабатываются программой и предъявляются пользователю - "невозможно выполнить операцию потому, что..."
При успешном завершении у пользователя есть на диске и СерверSQLБД новый пустой солюшен.

+++Пользователь просматривает свойства солюшена в проводнике
(несущественная для работы солюшена функция)
Пользователь выделяет ФайлСолюшена в Проводнике Виндовс. Запускается расширение проводника, которое читает информацию из ФайлСолюшена, выбирает нужное и отображает пользователю.

+++Пользователь открывает солюшен
Из РаботаПользователяССолюшеном
Пользователь находит на диске КаталогСолюшена, находит в ней ФайлСолюшена, кликает на нем.
Срабатывает механизм ассоциаций Виндовс, приложение получает путь к ФайлСолюшена.
Приложение вызывает функцию [MProject_ProjectOpen],передавая ей путь к ФайлСолюшена.
Эта операция выполняет работу по инициализации движка и при успешном завершении возвращает объект солюшена. Теперь пользователь может выполнять другие операции с солюшеном.
Если возникают ошибки, операция выкидывает исключения. Исключения обрабатываются программой и предъявляются пользователю - "невозможно выполнить операцию потому, что..."

+++Пользователь просматривает статистику солюшена
Из РаботаПользователяССолюшеном
Пользователь уже открыл солюшен и имеет ссылку на его объект.
Пользователь провел какие-то манипуляции в солюшене и теперь намерен посмотреть статистику.
Он командует приложению просмотреть статистику. Приложение вызывает [MProject_ProjectStatistic].
Эта операция возвращает приложению СтатистикаСолюшена. Приложение отображает СтатистикаСолюшена пользователю.
Если возникают ошибки, операция выкидывает исключения. Исключения обрабатываются программой и предъявляются пользователю - "невозможно выполнить операцию потому, что..."

+++Пользователь сохраняет солюшен
Из РаботаПользователяССолюшеном
Пользователь уже открыл [Солюшен] и имеет ссылку на его объект.
Пользователь провел какие-то манипуляции в солюшене и теперь намерен сохранить изменения.
Он командут приложению сохранить [Солюшен]. Приложение вызывает [MProject_ProjectSave]. Эта операция сохраняет [Солюшен] в БД и на диск.
Если возникают ошибки, операция выкидывает исключения. Исключения обрабатываются программой и предъявляются пользователю - "невозможно выполнить операцию потому, что..." 

+++Пользователь оптимизирует солюшен
Из РаботаПользователяССолюшеном
Пользователь уже открыл [Солюшен] и имеет ссылку на его объект.
Пользователь провел какие-то манипуляции в солюшене и теперь намерен оптимизировать структуру.
Он командует приложению оптимизировать солюшен. Приложение вызывает [MProject_ProjectOptimize]. Эта операция производит оптимизацию [Солюшен]. См [Оптимизатор]. Операция может занять много времени.
Если возникают ошибки, операция выкидывает исключения. Исключения обрабатываются программой и предъявляются пользователю - "невозможно выполнить операцию потому, что..."

+++Пользователь очищает солюшен
Из РаботаПользователяССолюшеном
Пользователь уже открыл [Солюшен] и имеет ссылку на его объект.
Пользователь провел какие-то манипуляции в солюшене и теперь намерен полностью удалить все из солюшена, чтобы солюшен был как новый.
Он командует приложению очистить [Солюшен]. Приложение вызывает [MProject_ProjectClear]. Эта операция производит очистку солюшена. Операция может занять много времени.
Если возникают ошибки, операция выкидывает исключения. Исключения обрабатываются программой и предъявляются пользователю - "невозможно выполнить операцию потому, что..."

+++Пользователь закрывает солюшен
Из РаботаПользователяССолюшеном
Пользователь уже открыл [Солюшен] и имеет ссылку на его объект.
Пользователь провел какие-то манипуляции в солюшене и теперь намерен завершить работу с солюшеном. Он командует приложению закрыть [Солюшен]. Приложение вызывает [MProject_ProjectClose]. Эта операция производит завершение работы движка. 
Если возникают ошибки, операция выкидывает исключения. Исключения обрабатываются программой и предъявляются пользователю - "невозможно выполнить операцию потому, что..."

+++Пользователь удаляет солюшен
Из РаботаПользователяССолюшеном
Пользователь закрыл [Солюшен] и не имеет ссылку на его объект.
Пользователь намерен удалить [Солюшен].
Он командует приложению удалить [Солюшен]. Приложение вызывает [MProject_ProjectDelete]. Эта операция производит удаление солюшена. Операция может занять много времени.
Если возникают ошибки, операция выкидывает исключения. Исключения обрабатываются программой и предъявляются пользователю - "невозможно выполнить операцию потому, что..."



