++ Концепция Снимков
[//В РАЗРАБОТКЕ]
++++Описание концепции
Описывает подсистему снимков.

++++ Состояние
* Эта подсистема была уже реализована и ее код лучше чем здешняя теория.
* Но эта тема проработана лишь наполовину. Есть много мелочей, которые надо выявить и учесть.
* В целом, бардак я разгреб, но тут много белых пятен.
* Сейчас мне от этой подсистемы надо только операции Создать ПолныйСнимокСтруктуры и Загрузить ранее созданный, возможно в другом Солюшене и с другой версией [Движок]а. Но они потребуют разных других функций, например, управления файлами снимков в КаталогСнимковСолюшена.
    * Потом прибавится еще ЧастичныйСнимокСтруктуры и его проблемы. Но это сейчас не существенно. 
    * Это сейчас простая схема - просто вывести то что есть в файл и прочитать из файла.
* Зависимости и задачи:
    * Нужен состав полей [Ячейка]и и [Связь]и для описания форматов секций. - Из КонцепцияСтруктурыСущностей.
    * Нужен состав полей свойств солюшена для описания формата СекцияКонтейнера - ОбсуждениеСоставСвойствСолюшена
    * Нужно проработать использование ЧастичныйСнимокСтруктуры - ТемаЧастичныйСнимокСтруктуры
    * Нужно проработать работу с файлами в ХранилищеСнимков. - ТемаУправлениеФайламиСнимков 
++++Задачи
1. Описать Снимок. ячейки и связи считать секциями, не вникая в их содержимое. - сделано 19.12.2016 03:06 
2. Описать общее строение ФайлСнимка абстрактно - сделано 19.12.2016 03:06 
3. Описать снимок как последовательность секций. - сделано 19.12.2016 03:06 
4. Перечислить типы секций и из порядок в ФайлСнимка. - сделано 19.12.2016 03:06 
5. Создать сущности предметной области: секции и все остальное. - сделано 22.12.2016 12:44 
6. Описать формат каждой секции приблизительно, так как он из старой версии Тапп, и заведомо частично неправильный.  - сделано 19.12.2016 03:06
7. Описать ограничения секций и почему секции в таком порядке. - не все ограничения выявлены. 22.12.2016 12:44 
8. Описать операции Выгрузка и Загрузка - накиданы примерно 26.12.2016 01:54 
9. Поставить задачу в план: Описать управление файлами снимков, чтобы можно было проектировать их функции.
10. решить, в какую папку КаталогСолюшена помещать ЧастичныйСнимокСтруктуры при создании.
    * Но не в КаталогСнимковСолюшена точно.
    А) Как СнимокРесурс, в ХранилищеРесурсовСолюшена.

+++Сборка версий
Сейчас тут кучей навалены тексты разных версий, надо:
1. Растаскать все материалы по темам Сборка ХХХХ. - сделано.
2. Каждую сборку просмотреть и превратить всю кучу текстов в один цельный, актуальный, адекватный текст.
3. Расставить вики-ссылки на термины в текстах.
4. Написать связный текст концепции ресурсов на этой странице.
5. Перенести тексты из сборок в соответствующие страницы сущностей глоссария.
6. Почистить страницы и привести их в удобный для чтения вид.

* СборкаКаталогСнимковСолюшена1

* СборкаХранилищеСнимков1

* СборкаСнимокСтруктуры1 - тут свалка на несколько сущностей. todo.концепция.снимки:  согласовать термины и названия секций из СборкаФорматДвоичногоСнимка1.
* СборкаЧастичныйСнимокСтруктуры1
* СборкаПолныйСнимокСтруктуры1
* СборкаСнимокРесурс1

* СборкаСериализация1 - обработано 16.06.2016 20:08

* СборкаФайлСнимка1 - дополнить 20.12.2016 07:09 

* СборкаМенеджерСнимков1 todo.концепция.снимки:  написать функции менеджера снимков, написать разработку форматов ВерсияПодсистемыСнимков, переработать типы секций для описания дублирующихся ячеек и связей. Решить, поддерживать ли удаление дубликатов ячеек и связей сразу, или отложить на будущие релизы. См. ТемаУменьшениеРазмераФайлаПолногоСнимка
    
* СборкаНомерШагаСолюшена1
* СборкаДеревоВерсийСолюшена1
* СборкаВетвьВерсииСолюшена1

* СборкаСтатистикаКонтейнера1 - дополнить 20.12.2016 07:05 

* СборкаФорматДвоичногоСнимка1 - устаревшие форматы секций из старой версии Тапп.
    todo.концепция.снимки: недостаточный список зависимостей порядка следования секций.
* СигнатураФайлаСнимка    

+++Материалы
++++Версии подсистемы
* Эта подсистема должна реализовываться как подпроект. Поэтому она имеет собственную версию. См. ТемаКакИспользоватьСолюшеныВБудущем
* Нужно реализовать проверку соответствия версии файлов снимков как часть проверки формата файла.
* СписокВерсийПодсистемыСнимков
* ВерсияПодсистемыСнимков

++++Свойства снимка
todo.концепция.снимки: Обдумать, нужно ли в ФайлСнимка хранить поле ТипСУБД солюшена? Теоретически вроде бы необязательно - Солюшен не должен зависеть от типа используемой БД, и соответственно, снимок сделанный на одной БД, должен без проблем работать на солюшене с лругой БД. Ну кроме быстродействия, количества элементов в таблице БД - тут у всех БД разные ограничения.
++++Внешние ячейки снимка
* Для ПолныйСнимокСтруктуры - это ячейки из других контейнеров. Их можно получить из общего списка связей ячеек, по ИД конечной ячейки, принадлежащей другому контейнеру. Но как с ней работать - нет концепции и опыта.
    * Нужна функция в КоллекцияСвязейЯчейки, которая отбирает внешние связи ячейки. Или в КоллекцияСвязейКонтейнера.
* Для ЧастичныйСнимокСтруктуры - это ячейки, связанные с ячейками, входящими в этот снимок. Если известны все ячейки, входящие в снимок, то можно выявить ВнешняяЯчейка ячейки. Это нужно, чтобы убедиться, что внешние ячейки не временные - то есть, для частичного снимка потребуется список ячеек входящих в снимок.
todo.концепция.снимки: Надо придумать лучшее название для ячеек, связанных с ячейками, входящими в частичный снимок.

++++Снимок структуры и проблемы частичного снимка
Для развития проекта Тапп предлагается распространение ее и дополнений (структур, реализующих пользовательскую функциональность) в виде файла. Возможно, с дополнением в виде нескольких СборкаКодаМетодов.
Для импорта/экспорта СтруктураСущностей целиком или определенных ее частей потребуется разработать сериализацию всей или произвольной части СтруктураСущностей в файл. ПолныйСнимокСтруктуры или ЧастичныйСнимокСтруктуры.

(Идея из версии Тапп1: Можно было реализовать импорт/экспорт как методы класса World. Метод мог бы добавлять новые классы и методы в СтруктураСущностей.) 

Однако при этом возникает проблема согласования идентификаторов. Экспортируемые ячейки снимка могут содержать ссылки на неэкспортируемые ячейки.
То есть, получается частичный экспорт. Эти ссылки при импорте должны быть разрешены, но каким образом? 
 * Выводить сообщение в процессе предварительного просмотра файла.
При импорте (загрузке) ЧастичныйСнимокСтруктуры придется заменять идентификаторы вновь добавляемых ячеек на идентификаторы, свободные в данный момент в СтруктураСущностей. Может не быть нужной ячейки. Предпочтительно все же экспортировать всю СтруктураСущностей или все связанные сущности, кроме сущностей стандартной поставки.
То есть, сущности придется еще разделять на стандартный набор и пользовательские дополнения. 
Или экспортировать и стандартные сущности, это удобно, если они были модифицированы. 
 Тогда надо только убедиться, что они есть, и что это именно они, потом достроить измененную часть.
 А еще будут версии сущностей. В общем, мрак. Вместе с ид тогда следует хранить хеш - идентификатор, версию, имя сущности. Для точного определения.


